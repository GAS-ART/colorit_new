function q(i){const o=document.getElementById(i),v=document.getElementById("body"),r=o.querySelector(".close-popup"),s=o.querySelector(".popup__button"),e=o.querySelector(".popup__loading"),a=o.querySelector(".preview-file")||!1,d=o.querySelectorAll("input");o.classList.add("open"),v.classList.add("lock"),r.addEventListener("click",function(n){p(o),n.preventDefault()}),s.addEventListener("click",function(){p(o)});function p(n){n.classList.remove("open"),v.classList.remove("lock"),o.classList.remove("sent"),d.forEach(l=>{l.value||(l.previousElementSibling.classList.remove("error"),l.classList.remove("error"),l.nextElementSibling.classList.remove("error"),l.nextElementSibling.innerHTML="")}),a&&(a.innerHTML="")}o.addEventListener("mousedown",function(n){!n.target.closest(".popup__body")&&!e.classList.contains("active")&&p(o)})}const k=document.querySelectorAll(".link-on-popup");k.forEach(i=>{i.addEventListener("click",o=>{q(o.target.dataset.popupId)})});const L=document.querySelector(".language-btn");L.addEventListener("click",function(i){window.matchMedia("(pointer: coarse)").matches&&(L.classList.contains("active")||i.preventDefault(),L.classList.toggle("active"))});const w=document.querySelectorAll("form"),c={name:['Не заполнено поле "ВАШЕ ИМЯ"',`Не заповнено поле "ВАШЕ ІМ'Я"`,'Поле "ИМЯ" должно иметь 2 или больше символов',`Поле "ІМ'Я" повинно мати 2 або більше символів`,'Поле "ИМЯ" должно иметь не больше 80 символов',`Поле "ІМ'Я" повинно мати не більше 80 символів`,'Поле "ИМЯ" не может содержать цифры',`Поле "ІМ'Я" не може містити цифри`],phone:["Не верный формат номера телефона","Невірний формат номеру телефона",'Не заполнено поле "Номер телефона"','Не заповнено поле "Номер телефону"'],text:['Вы ввели слишком много символов в поле "Сообщение"','Ви ввели занадто багато символів у полі "Повідомлення"']};w.forEach(i=>{i.addEventListener("submit",async o=>{var n,l,g,E,S,b,x,f,h,y,T;o.preventDefault();const v=i.querySelector('input[name="_token"]').value,r=i.querySelector(".error-name"),s=i.querySelector(".error-phone"),e=i.querySelector(".error-text"),a=i.closest(".popup__row").previousElementSibling.previousElementSibling;a.classList.add("active");const d=new FormData(i),p="http://localhost:8000/send-main-form";try{const u=await fetch(p,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-Token":v},method:"post",body:d,credentials:"same-origin"});if(u.ok)a.classList.remove("active"),i.closest(".popup").classList.add("sent"),r.innerText="",r.classList.remove("error"),r.previousElementSibling.classList.remove("error"),r.previousElementSibling.previousElementSibling.classList.remove("error"),s.innerText="",s.classList.remove("error"),s.previousElementSibling.classList.remove("error"),s.previousElementSibling.previousElementSibling.classList.remove("error"),e&&(e.innerText="",e.classList.remove("error"),e.previousElementSibling.classList.remove("error"),e.previousElementSibling.previousElementSibling.classList.remove("error")),i.reset();else{const t=await u.json();a.classList.remove("active"),i.classList.contains("ru")?((n=t.errors)!=null&&n.name?(r.innerText=(l=t.errors)==null?void 0:l.name[0],r.classList.add("error"),r.previousElementSibling.classList.add("error"),r.previousElementSibling.previousElementSibling.classList.add("error"),console.log(r.previousElementSibling)):(r.innerText="",r.classList.remove("error"),r.previousElementSibling.classList.remove("error"),r.previousElementSibling.previousElementSibling.classList.remove("error")),(g=t.errors)!=null&&g.phone?(s.innerText=(E=t.errors)==null?void 0:E.phone[0],s.classList.add("error"),s.previousElementSibling.classList.add("error"),s.previousElementSibling.previousElementSibling.classList.add("error")):(s.innerText="",s.classList.remove("error"),s.previousElementSibling.classList.remove("error"),s.previousElementSibling.previousElementSibling.classList.remove("error")),(S=t.errors)!=null&&S.text?(e.innerText=(b=t.errors)==null?void 0:b.text[0],e.classList.add("error"),e.previousElementSibling.classList.add("error"),e.previousElementSibling.previousElementSibling.classList.add("error")):!((x=t.errors)!=null&&x.text)&&e&&(e.innerText="",e.classList.remove("error"),e.previousElementSibling.classList.remove("error"),e.previousElementSibling.previousElementSibling.classList.remove("error"))):((f=t.errors)!=null&&f.name?(r.innerText=c.name[c.name.findIndex(m=>m==t.errors.name[0])+1],r.classList.add("error"),r.previousElementSibling.classList.add("error"),r.previousElementSibling.previousElementSibling.classList.add("error")):(r.innerText="",r.classList.remove("error"),r.previousElementSibling.classList.remove("error"),r.previousElementSibling.previousElementSibling.classList.remove("error")),(h=t.errors)!=null&&h.phone?(s.innerText=c.phone[c.phone.findIndex(m=>m==t.errors.phone[0])+1],s.classList.add("error"),s.previousElementSibling.classList.add("error"),s.previousElementSibling.previousElementSibling.classList.add("error")):(s.innerText="",s.classList.remove("error"),s.previousElementSibling.classList.remove("error"),s.previousElementSibling.previousElementSibling.classList.remove("error")),(y=t.errors)!=null&&y.text?(e.innerText=c.text[c.text.findIndex(m=>m==t.errors.text[0])+1],e.classList.add("error"),e.previousElementSibling.classList.add("error"),e.previousElementSibling.previousElementSibling.classList.add("error")):!((T=t.errors)!=null&&T.text)&&e&&(e.innerText="",e.classList.remove("error"),e.previousElementSibling.classList.remove("error"),e.previousElementSibling.previousElementSibling.classList.remove("error")))}}catch(u){console.log(u)}})});
